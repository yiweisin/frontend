(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{12451:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(95155);function i(e){let{trade:t,onSell:s,onDelete:i}=e,n=t.isHolding&&t.currentPrice?(t.currentPrice-t.entryPrice)*100/100:t.pnl,o=n.toFixed(2),a=n>=0?"text-emerald-600":"text-rose-600",l=t.isHolding&&t.currentPrice?(t.currentPrice-t.entryPrice)/t.entryPrice*100:t.pnl/t.entryPrice*100,c=l.toFixed(2),d=l>=0?"+":"",x=async()=>{t.isHolding&&t.currentPrice&&await s(t.id,n)};return(0,r.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"font-medium text-slate-800",children:t.stockSymbol}),(0,r.jsx)("div",{className:"text-sm text-slate-500",children:t.stockName})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,r.jsxs)("div",{className:"font-medium text-slate-700",children:["$",t.entryPrice.toFixed(2)]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:t.isHolding&&t.currentPrice?(0,r.jsxs)("div",{className:"font-medium text-slate-800",children:["$",t.currentPrice.toFixed(2)]}):(0,r.jsx)("div",{className:"text-slate-400",children:"â€”"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,r.jsxs)("div",{className:"font-medium ".concat(a),children:[n>=0?"+":"",o,(0,r.jsxs)("span",{className:"text-xs ml-1",children:["(",d,c,"%)"]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-slate-600",children:new Date(t.date).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium ".concat(t.isHolding?"bg-indigo-100 text-indigo-800":"bg-slate-100 text-slate-800"),children:t.isHolding?"Active":"Closed"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:(0,r.jsx)("div",{className:"flex justify-center space-x-2",children:t.isHolding?(0,r.jsxs)("button",{onClick:x,className:"px-3 py-1.5 text-xs bg-slate-700 text-white rounded-md hover:bg-slate-800 transition-colors shadow-sm flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:(0,r.jsx)("path",{d:"M9 18l6-6-6-6"})}),"Sell"]}):(0,r.jsxs)("button",{onClick:()=>i(t.id),className:"px-3 py-1.5 text-xs bg-rose-500 text-white rounded-md hover:bg-rose-600 transition-colors shadow-sm flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-1",children:[(0,r.jsx)("path",{d:"M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"}),(0,r.jsx)("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),(0,r.jsx)("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]}),"Delete"]})})})]})}s(12115)},25731:(e,t,s)=>{"use strict";s.d(t,{$L:()=>m,Lp:()=>x,Tw:()=>c,Y5:()=>h,ZI:()=>d,iD:()=>n,kz:()=>o,ri:()=>a,s5:()=>p,tK:()=>u,yW:()=>l});let r="http://localhost:5141/api";async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=JSON.parse(localStorage.getItem("user")||"{}");s.token?(console.log("Using token for request:",e),t.headers={...t.headers,Authorization:"Bearer ".concat(s.token)}):console.warn("No token found for request:",e);let r=await fetch(e,t);if(401===r.status)throw console.error("Unauthorized request:",e),localStorage.removeItem("user"),window.location.href="/login",Error("Unauthorized");return r}async function n(e){console.log("API login function called with:",e.username);try{let t=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Login response status:",t.status),!t.ok){let e=await t.text();throw console.error("Login error response:",e),Error(e||"Login failed")}let s=await t.json();return console.log("Login successful, user data:",s),localStorage.setItem("user",JSON.stringify(s)),console.log("User saved to localStorage"),s}catch(e){throw console.error("API login error:",e),e}}async function o(e){let t=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Registration failed");let s=await t.json();return localStorage.setItem("user",JSON.stringify(s)),s}async function a(){localStorage.removeItem("user")}async function l(){let e=await i("".concat(r,"/stocks"));if(!e.ok)throw Error("Failed to fetch stocks");return e.json()}async function c(e){let t=await i("".concat(r,"/stocks/").concat(e));if(!t.ok)throw Error("Failed to fetch stock");return t.json()}async function d(){let e=await i("".concat(r,"/stocks/prices"));if(!e.ok)throw Error("Failed to fetch stock prices");return e.json()}async function x(e){let t=await i("".concat(r,"/stocks/").concat(e,"/history"));if(!t.ok)throw Error("Failed to fetch stock history");return t.json()}async function h(){let e=await i("".concat(r,"/trades"));if(!e.ok)throw Error("Failed to fetch trades");return e.json()}async function m(e){let t=await i("".concat(r,"/trades"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create trade");return t.json()}async function u(e,t){if(!(await i("".concat(r,"/trades/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({pnl:t,isHolding:!1})})).ok)throw Error("Failed to sell trade")}async function p(e){if(!(await i("".concat(r,"/trades/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete trade")}},33792:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(95155),i=s(12115),n=s(6874),o=s.n(n),a=s(35695),l=s(59576),c=s(25731),d=s(12451);function x(){let{user:e,loading:t}=(0,l.A)(),s=(0,a.useRouter)(),[n,x]=(0,i.useState)([]),[h,m]=(0,i.useState)([]),[u,p]=(0,i.useState)(!0),[g,w]=(0,i.useState)(null),[f,j]=(0,i.useState)(0);(0,i.useEffect)(()=>{t||e||s.push("/login")},[e,t,s]);let y=(0,i.useCallback)(async()=>{try{p(!0),w(null);let[e,,t]=await Promise.all([(0,c.Y5)(),(0,c.yW)(),(0,c.ZI)()]);m(e);let s=e.filter(e=>e.isHolding).map(e=>{let s=t.find(t=>t.id===e.stockId);return s?{...e,currentPrice:s.price}:e});x(s)}catch(e){w("Failed to fetch data"),console.error(e)}finally{p(!1)}},[]);(0,i.useEffect)(()=>{e&&y()},[y,e]),(0,i.useEffect)(()=>{if(!e)return;let t=setInterval(()=>{j(e=>e+1)},500);return()=>clearInterval(t)},[e]),(0,i.useEffect)(()=>{f>0&&e&&(async()=>{try{let e=await (0,c.ZI)();x(t=>t.map(t=>{let s=e.find(e=>e.id===t.stockId);return s?{...t,currentPrice:s.price}:t}))}catch(e){console.error("Failed to update prices:",e)}})()},[f,e]);let v=async(e,t)=>{try{await (0,c.tK)(e,t),y()}catch(e){w("Failed to sell trade"),console.error(e)}},N=n.length,k=h.reduce((e,t)=>{if(!t.isHolding)return e+t.pnl;if(t.isHolding){let s=n.find(e=>e.id===t.id);if(s&&s.currentPrice)return e+(s.currentPrice-t.entryPrice)}return e},0),b=h.filter(e=>{if(!e.isHolding)return e.pnl>0;let t=n.find(t=>t.id===e.id);return!!t&&!!t.currentPrice&&t.currentPrice>e.entryPrice}),P=h.length>0?b.length/h.length*100:0;return t||!e?(0,r.jsx)("div",{className:"flex items-center justify-center h-96 bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-700 font-medium",children:"Loading your dashboard..."})]})}):u&&0===n.length?(0,r.jsx)("div",{className:"flex items-center justify-center h-96 bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-700 font-medium",children:"Loading your portfolio..."})]})}):g?(0,r.jsx)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:(0,r.jsxs)("div",{className:"text-center py-8 px-4 bg-rose-50 text-rose-700 rounded-lg border border-rose-200",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-3 text-rose-500",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Data"}),(0,r.jsx)("p",{children:g})]})}):(0,r.jsx)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 px-8 py-6 text-white",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold",children:["Welcome, ",e.username]}),(0,r.jsx)("p",{className:"text-slate-300 mt-1",children:"Your Portfolio Dashboard"})]}),(0,r.jsxs)("div",{className:"bg-slate-600/40 rounded-lg px-4 py-2 flex items-center",children:[(0,r.jsx)("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(f>0?"bg-emerald-400 animate-pulse":"bg-slate-400")}),(0,r.jsx)("span",{className:"text-sm font-medium text-slate-200",children:f>0?"Live Updates":"Connecting..."})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mt-8",children:[(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-4 bg-indigo-400/20 rounded-lg p-3",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-indigo-300",children:[(0,r.jsx)("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"}),(0,r.jsx)("line",{x1:"8",y1:"21",x2:"16",y2:"21"}),(0,r.jsx)("line",{x1:"12",y1:"17",x2:"12",y2:"21"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"Active Positions"}),(0,r.jsx)("p",{className:"text-2xl font-bold mt-1",children:N})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-4 bg-emerald-400/20 rounded-lg p-3",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:k>=0?"text-emerald-300":"text-rose-300",children:[(0,r.jsx)("line",{x1:"12",y1:"20",x2:"12",y2:"10"}),(0,r.jsx)("line",{x1:"18",y1:"20",x2:"18",y2:"4"}),(0,r.jsx)("line",{x1:"6",y1:"20",x2:"6",y2:"16"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"Total P&L"}),(0,r.jsxs)("p",{className:"text-2xl font-bold mt-1 ".concat(k>=0?"text-emerald-400":"text-rose-400"),children:[k>=0?"+":"",k.toFixed(2)]})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-4 bg-blue-400/20 rounded-lg p-3",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-blue-300",children:(0,r.jsx)("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"Win Rate"}),(0,r.jsxs)("p",{className:"text-2xl font-bold mt-1",children:[P.toFixed(1),"%"]})]})]})}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"mr-4 bg-violet-400/20 rounded-lg p-3",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-violet-300",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("polyline",{points:"12 6 12 12 16 14"})]})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"Total Trades"}),(0,r.jsx)("p",{className:"text-2xl font-bold mt-1",children:h.length})]})]})})]}),(0,r.jsxs)("div",{className:"flex gap-4 mt-8",children:[(0,r.jsxs)(o(),{href:"/stocks",className:"px-5 py-2.5 rounded-lg font-medium shadow-sm transition-all flex items-center bg-emerald-500 hover:bg-emerald-600 text-white",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:(0,r.jsx)("path",{d:"M12 5v14M5 12h14"})}),"Buy Stock"]}),(0,r.jsxs)(o(),{href:"/trades",className:"px-5 py-2.5 bg-slate-600 hover:bg-slate-700 text-white rounded-lg font-medium shadow-sm transition-all flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:[(0,r.jsx)("rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"}),(0,r.jsx)("line",{x1:"16",y1:"2",x2:"16",y2:"6"}),(0,r.jsx)("line",{x1:"8",y1:"2",x2:"8",y2:"6"}),(0,r.jsx)("line",{x1:"3",y1:"10",x2:"21",y2:"10"})]}),"Trade History"]})]})]}),(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-xl font-semibold mb-6 text-slate-800 flex items-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2 text-indigo-500",children:[(0,r.jsx)("path",{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"}),(0,r.jsx)("path",{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"})]}),"Active Positions"]}),0===n.length?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 bg-slate-50 rounded-xl border border-slate-200 text-center",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round",className:"mb-4 text-slate-400",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("path",{d:"M8 15h8M9 9h.01M15 9h.01"})]}),(0,r.jsx)("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"No Active Positions"}),(0,r.jsx)("p",{className:"text-slate-500 max-w-md",children:'You don\'t have any active positions at the moment. Click the "Buy Stock" button to add your first position.'})]}):(0,r.jsx)("div",{className:"overflow-x-auto border border-slate-200 rounded-xl",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-slate-50",children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Stock"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Entry Price"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Current Price"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-right text-xs font-medium text-slate-500 uppercase tracking-wider",children:"P&L"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Date"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-left text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Status"}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-center text-xs font-medium text-slate-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-slate-200",children:n.map(e=>(0,r.jsx)(d.A,{trade:e,onSell:v,onDelete:()=>{}},e.id))})]})})]})})]})})}},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},59576:(e,t,s)=>{"use strict";s.d(t,{A:()=>c,AuthProvider:()=>l});var r=s(95155),i=s(12115),n=s(25731),o=s(35695);let a=(0,i.createContext)({user:null,login:async()=>{},register:async()=>{},logout:async()=>{},loading:!0}),l=e=>{let{children:t}=e,[s,l]=(0,i.useState)(null),[c,d]=(0,i.useState)(!0),x=(0,o.useRouter)();(0,i.useEffect)(()=>{let e=localStorage.getItem("user");e&&l(JSON.parse(e)),d(!1)},[]);let h=async e=>{try{let t=await (0,n.iD)(e);l(t),x.push("/")}catch(e){throw e}},m=async e=>{try{let t=await (0,n.kz)(e);l(t),x.push("/")}catch(e){throw e}},u=async()=>{await (0,n.ri)(),l(null),x.push("/login")};return(0,r.jsx)(a.Provider,{value:{user:s,login:h,register:m,logout:u,loading:c},children:t})},c=()=>(0,i.useContext)(a)},75670:(e,t,s)=>{Promise.resolve().then(s.bind(s,33792))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,441,684,358],()=>t(75670)),_N_E=e.O()}]);