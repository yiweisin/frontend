(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{25731:(e,t,s)=>{"use strict";s.d(t,{$L:()=>x,Lp:()=>h,Tw:()=>c,Y5:()=>u,ZI:()=>d,iD:()=>a,kz:()=>n,ri:()=>i,s5:()=>p,tK:()=>m,yW:()=>l});let r="http://localhost:5141/api";async function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=JSON.parse(localStorage.getItem("user")||"{}");s.token?(console.log("Using token for request:",e),t.headers={...t.headers,Authorization:"Bearer ".concat(s.token)}):console.warn("No token found for request:",e);let r=await fetch(e,t);if(401===r.status)throw console.error("Unauthorized request:",e),localStorage.removeItem("user"),window.location.href="/login",Error("Unauthorized");return r}async function a(e){console.log("API login function called with:",e.username);try{let t=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Login response status:",t.status),!t.ok){let e=await t.text();throw console.error("Login error response:",e),Error(e||"Login failed")}let s=await t.json();return console.log("Login successful, user data:",s),localStorage.setItem("user",JSON.stringify(s)),console.log("User saved to localStorage"),s}catch(e){throw console.error("API login error:",e),e}}async function n(e){let t=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Registration failed");let s=await t.json();return localStorage.setItem("user",JSON.stringify(s)),s}async function i(){localStorage.removeItem("user")}async function l(){let e=await o("".concat(r,"/stocks"));if(!e.ok)throw Error("Failed to fetch stocks");return e.json()}async function c(e){let t=await o("".concat(r,"/stocks/").concat(e));if(!t.ok)throw Error("Failed to fetch stock");return t.json()}async function d(){let e=await o("".concat(r,"/stocks/prices"));if(!e.ok)throw Error("Failed to fetch stock prices");return e.json()}async function h(e){let t=await o("".concat(r,"/stocks/").concat(e,"/history"));if(!t.ok)throw Error("Failed to fetch stock history");return t.json()}async function u(){let e=await o("".concat(r,"/trades"));if(!e.ok)throw Error("Failed to fetch trades");return e.json()}async function x(e){let t=await o("".concat(r,"/trades"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create trade");return t.json()}async function m(e,t){if(!(await o("".concat(r,"/trades/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({pnl:t,isHolding:!1})})).ok)throw Error("Failed to sell trade")}async function p(e){if(!(await o("".concat(r,"/trades/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete trade")}},28586:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i});var r=s(95155),o=s(12115),a=s(25731),n=s(35695);function i(){let e=(0,n.useRouter)(),[t,s]=(0,o.useState)([]),[i,l]=(0,o.useState)(!0),[c,d]=(0,o.useState)(null),[h,u]=(0,o.useState)(0),[x,m]=(0,o.useState)({}),[p,f]=(0,o.useState)({key:"symbol",direction:"ascending"}),[g,w]=(0,o.useState)("");(0,o.useEffect)(()=>{(async()=>{try{l(!0),d(null);let e=await (0,a.yW)();s(e);let t={};for(let s of e)try{let e=await (0,a.Lp)(s.id);e.length>=2&&(t[s.id]=e[1].price)}catch(e){console.error("Failed to fetch history for stock ".concat(s.id,":"),e)}m(t)}catch(e){d("Failed to fetch stocks"),console.error(e)}finally{l(!1)}})();let e=setInterval(()=>{u(e=>e+1)},500);return()=>clearInterval(e)},[]),(0,o.useEffect)(()=>{h>0&&(async()=>{try{let e=await (0,a.ZI)();s(t=>t.map(t=>{let s=e.find(e=>e.id===t.id);return s?{...t,price:s.price}:t}))}catch(e){console.error("Failed to update prices:",e)}})()},[h]);let y=(0,o.useCallback)(e=>{let t=x[e.id];if(!t)return{value:0,percentage:0};let s=e.price-t;return{value:s,percentage:s/t*100}},[x]),j=e=>e>0?"text-emerald-600":e<0?"text-rose-600":"text-slate-500",k=t=>{e.push("/stocks/".concat(t))},v=e=>{let t="ascending";p.key===e&&"ascending"===p.direction&&(t="descending"),f({key:e,direction:t})},N=t.filter(e=>e.symbol.toLowerCase().includes(g.toLowerCase())||e.name.toLowerCase().includes(g.toLowerCase())),b=o.useMemo(()=>{let e=[...N];return p.key&&e.sort((e,t)=>{if("daily"===p.key){let s=y(e).percentage,r=y(t).percentage;return s<r?"ascending"===p.direction?-1:1:s>r?"ascending"===p.direction?1:-1:0}return e[p.key]<t[p.key]?"ascending"===p.direction?-1:1:e[p.key]>t[p.key]?"ascending"===p.direction?1:-1:0}),e},[N,p,y]),C=e=>p.key!==e?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-1 text-slate-400 opacity-0 group-hover:opacity-100",children:(0,r.jsx)("path",{d:"M7 15l5 5 5-5M7 9l5-5 5 5"})}):"ascending"===p.direction?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-1 text-slate-700",children:(0,r.jsx)("path",{d:"M18 15l-6-6-6 6"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"ml-1 text-slate-700",children:(0,r.jsx)("path",{d:"M6 9l6 6 6-6"})});return i?(0,r.jsx)("div",{className:"flex items-center justify-center h-96 bg-slate-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-slate-700 font-medium",children:"Loading stocks..."})]})}):c?(0,r.jsx)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:(0,r.jsxs)("div",{className:"text-center py-8 px-4 bg-rose-50 text-rose-700 rounded-lg border border-rose-200",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-3 text-rose-500",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Stocks"}),(0,r.jsx)("p",{children:c})]})}):(0,r.jsx)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-r from-slate-800 to-slate-700 px-8 py-6 text-white",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"Market Overview"}),(0,r.jsxs)("div",{className:"bg-slate-600/40 rounded-lg px-4 py-2 flex items-center",children:[(0,r.jsx)("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(h>0?"bg-emerald-400 animate-pulse":"bg-slate-400")}),(0,r.jsx)("span",{className:"text-sm font-medium text-slate-200",children:h>0?"Live Updates":"Connecting..."})]})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by symbol or company name...",value:g,onChange:e=>{w(e.target.value)},className:"w-full py-3 px-4 pr-10 bg-white/10 backdrop-blur-sm border border-slate-600/50 rounded-lg text-white placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),g&&(0,r.jsx)("button",{onClick:()=>{w("")},className:"absolute right-12 top-1/2 transform -translate-y-1/2 text-slate-300 hover:text-white",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),(0,r.jsx)("line",{x1:"9",y1:"9",x2:"15",y2:"15"})]})}),(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-300",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"11",cy:"11",r:"8"}),(0,r.jsx)("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]})})]})})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-slate-200",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"bg-slate-50",children:[(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-left text-sm font-semibold text-slate-700 cursor-pointer group",onClick:()=>v("symbol"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Symbol",C("symbol")]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-left text-sm font-semibold text-slate-700 cursor-pointer group",onClick:()=>v("name"),children:(0,r.jsxs)("div",{className:"flex items-center",children:["Company",C("name")]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-right text-sm font-semibold text-slate-700 cursor-pointer group",onClick:()=>v("price"),children:(0,r.jsxs)("div",{className:"flex items-center justify-end",children:["Price",C("price")]})}),(0,r.jsx)("th",{scope:"col",className:"px-6 py-4 text-right text-sm font-semibold text-slate-700 cursor-pointer group",onClick:()=>v("daily"),children:(0,r.jsxs)("div",{className:"flex items-center justify-end",children:["Daily Change",C("daily")]})})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-slate-200 bg-white",children:0===b.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-6 py-10 text-center text-slate-500",children:g?'No stocks found matching "'.concat(g,'"'):"No stocks available."})}):b.map(e=>{let t=y(e),s=j(t.value);return(0,r.jsxs)("tr",{className:"hover:bg-slate-50 transition-colors cursor-pointer",onClick:()=>k(e.id),children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"font-semibold text-slate-800",children:e.symbol})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-slate-700",children:e.name})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,r.jsxs)("div",{className:"font-medium text-slate-800",children:["$",e.price.toFixed(2)]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,r.jsxs)("div",{className:"font-medium ".concat(s),children:[t.value>0?"+":"",t.value.toFixed(2)," (",t.value>0?"+":"",t.percentage.toFixed(2),"%)"]})})]},e.id)})})]})})]})})}},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},79770:(e,t,s)=>{Promise.resolve().then(s.bind(s,28586))}},e=>{var t=t=>e(e.s=t);e.O(0,[441,684,358],()=>t(79770)),_N_E=e.O()}]);