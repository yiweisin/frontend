(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[586],{25731:(e,t,s)=>{"use strict";s.d(t,{$L:()=>m,Lp:()=>h,Tw:()=>c,Y5:()=>x,ZI:()=>d,iD:()=>o,kz:()=>l,ri:()=>n,s5:()=>f,tK:()=>u,yW:()=>i});let a="http://localhost:5141/api";async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=JSON.parse(localStorage.getItem("user")||"{}");s.token?(console.log("Using token for request:",e),t.headers={...t.headers,Authorization:"Bearer ".concat(s.token)}):console.warn("No token found for request:",e);let a=await fetch(e,t);if(401===a.status)throw console.error("Unauthorized request:",e),localStorage.removeItem("user"),window.location.href="/login",Error("Unauthorized");return a}async function o(e){console.log("API login function called with:",e.username);try{let t=await fetch("".concat(a,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("Login response status:",t.status),!t.ok){let e=await t.text();throw console.error("Login error response:",e),Error(e||"Login failed")}let s=await t.json();return console.log("Login successful, user data:",s),localStorage.setItem("user",JSON.stringify(s)),console.log("User saved to localStorage"),s}catch(e){throw console.error("API login error:",e),e}}async function l(e){let t=await fetch("".concat(a,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(await t.text()||"Registration failed");let s=await t.json();return localStorage.setItem("user",JSON.stringify(s)),s}async function n(){localStorage.removeItem("user")}async function i(){let e=await r("".concat(a,"/stocks"));if(!e.ok)throw Error("Failed to fetch stocks");return e.json()}async function c(e){let t=await r("".concat(a,"/stocks/").concat(e));if(!t.ok)throw Error("Failed to fetch stock");return t.json()}async function d(){let e=await r("".concat(a,"/stocks/prices"));if(!e.ok)throw Error("Failed to fetch stock prices");return e.json()}async function h(e){let t=await r("".concat(a,"/stocks/").concat(e,"/history"));if(!t.ok)throw Error("Failed to fetch stock history");return t.json()}async function x(){let e=await r("".concat(a,"/trades"));if(!e.ok)throw Error("Failed to fetch trades");return e.json()}async function m(e){let t=await r("".concat(a,"/trades"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create trade");return t.json()}async function u(e,t){if(!(await r("".concat(a,"/trades/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({pnl:t,isHolding:!1})})).ok)throw Error("Failed to sell trade")}async function f(e){if(!(await r("".concat(a,"/trades/").concat(e),{method:"DELETE"})).ok)throw Error("Failed to delete trade")}},39924:(e,t,s)=>{Promise.resolve().then(s.bind(s,96988))},96988:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(95155),r=s(12115),o=s(35695),l=s(25731),n=s(83540),i=s(94456),c=s(94754),d=s(96025),h=s(16238),x=s(94517),m=s(70919),u=s(21374);function f(){let e=(0,o.useParams)(),t=(0,o.useRouter)(),s=Number(e.id),[f,p]=(0,r.useState)(null),[g,w]=(0,r.useState)([]),[j,b]=(0,r.useState)(null),[y,N]=(0,r.useState)(null),[k,v]=(0,r.useState)(!0),[S,L]=(0,r.useState)(null),[D,C]=(0,r.useState)(0),[F,M]=(0,r.useState)("1M"),[E,P]=(0,r.useState)(!1),[T,O]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(!s||isNaN(s)){L("Invalid stock ID"),v(!1);return}try{v(!0),L(null);let e=await (0,l.Tw)(s);p(e);let t=(await (0,l.Lp)(s)).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());w(t),I(t)}catch(e){console.error("Failed to fetch stock data:",e),L("Failed to load stock information")}finally{v(!1)}})();let e=setInterval(()=>{C(e=>e+1)},500);return()=>clearInterval(e)},[s]);let I=e=>{if(!e||e.length<4){b(null),N(null);return}let t=e[e.length-1].price,s=Math.max(0,e.length-4),a=e[s].price;N((t-a)/a*100);let r=Math.max(0,e.length-8),o=e[r].price;b((t-o)/o*100)};(0,r.useEffect)(()=>{D>0&&f&&(async()=>{try{let e=(await (0,l.ZI)()).find(e=>e.id===s);if(e&&(p(t=>t?{...t,price:e.price}:null),g.length>0)){let e=[...g];I(e)}}catch(e){console.error("Failed to update price:",e)}})()},[D,s,f,g]);let W=()=>{t.back()},B=async()=>{O(!0);try{f&&await (0,l.$L)({stockId:s,entryPrice:f.price,isHolding:!0}),O(!1),P(!0)}catch(e){L("Failed to add trade"),console.error(e)}},A=e=>{if(null===e)return(0,a.jsx)("span",{className:"text-gray-400",children:"N/A"});let t=e>=0;return(0,a.jsxs)("span",{className:"font-semibold ".concat(t?"text-emerald-600":"text-rose-600"),children:[t?"+":"",e.toFixed(2),"%"]})},U=(()=>{if(0===g.length)return[];let e=new Date,t=new Date;switch(F){case"1W":t.setDate(e.getDate()-7);break;case"1M":t.setMonth(e.getMonth()-1);break;case"3M":t.setMonth(e.getMonth()-3);break;case"1Y":t.setFullYear(e.getFullYear()-1);break;default:t=new Date(0)}return g.map(e=>({fullDate:new Date(e.date),date:e.date,price:e.price})).filter(e=>e.fullDate>=t).sort((e,t)=>e.fullDate.getTime()-t.fullDate.getTime())})(),z=U.length>0?.98*Math.min(...U.map(e=>e.price)):0,H=U.length>0?1.02*Math.max(...U.map(e=>e.price)):100;return k?(0,a.jsx)("div",{className:"flex items-center justify-center h-96 bg-slate-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-slate-200 border-t-slate-800 rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-slate-700 font-medium",children:"Loading stock information..."})]})}):S||!f?(0,a.jsxs)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:[(0,a.jsxs)("button",{onClick:W,className:"mb-4 px-5 py-2.5 bg-slate-700 text-white rounded-md hover:bg-slate-800 transition-colors font-medium flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:(0,a.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Stocks"]}),(0,a.jsxs)("div",{className:"text-center py-8 px-4 bg-rose-50 text-rose-700 rounded-lg border border-rose-200",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-3 text-rose-500",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,a.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Error Loading Stock"}),(0,a.jsx)("p",{children:S||"Stock not found"})]})]}):(0,a.jsxs)("div",{className:"max-w-7xl mx-auto my-8 px-6",children:[(0,a.jsx)("style",{children:"\n    @keyframes fade-in {\n      from { opacity: 0; transform: translate(-50%, -20px); }\n      to { opacity: 1; transform: translate(-50%, 0); }\n    }\n    .animate-fade-in {\n      animation: fade-in 0.3s ease-out forwards;\n    }\n  "}),E&&(0,a.jsxs)("div",{className:"fixed top-6 left-1/2 transform -translate-x-1/2 z-50 bg-white shadow-xl rounded-lg border border-emerald-100 p-4 flex items-center max-w-md animate-fade-in",children:[(0,a.jsx)("div",{className:"bg-emerald-100 rounded-full p-2 mr-4",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-800",children:"Purchase Successful!"}),(0,a.jsxs)("p",{className:"text-sm text-slate-600",children:["You've successfully purchased ",f.symbol," shares."]})]}),(0,a.jsx)("button",{onClick:()=>P(!1),className:"ml-4 text-slate-400 hover:text-slate-600",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,a.jsxs)("button",{onClick:W,className:"mb-6 px-5 py-2.5 bg-slate-700 text-white rounded-md hover:bg-slate-800 transition-colors font-medium flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"mr-2",children:(0,a.jsx)("path",{d:"M19 12H5M12 19l-7-7 7-7"})}),"Back to Stocks"]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden",children:[(0,a.jsx)("div",{className:"relative bg-gradient-to-r from-slate-800 to-slate-700 px-8 py-7 text-white",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:f.symbol}),(0,a.jsx)("span",{className:"mx-3 text-slate-400",children:"|"}),(0,a.jsx)("h2",{className:"text-2xl font-medium text-slate-100",children:f.name})]}),(0,a.jsxs)("div",{className:"mt-5 flex items-baseline",children:[(0,a.jsxs)("span",{className:"text-4xl font-bold",children:["$",f.price.toFixed(2)]}),(0,a.jsxs)("div",{className:"ml-4 flex gap-4",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"3D"}),(0,a.jsx)("div",{className:"text-base",children:A(y)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"text-xs text-slate-300 uppercase font-medium",children:"7D"}),(0,a.jsx)("div",{className:"text-base",children:A(j)})]})]})]}),(0,a.jsx)("button",{onClick:B,disabled:T,className:"mt-4 px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white font-medium rounded-lg shadow-md transition-all flex items-center disabled:opacity-70 disabled:cursor-not-allowed",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Buy Now"]})})]}),(0,a.jsxs)("div",{className:"bg-slate-600/40 rounded-lg px-4 py-2 flex items-center",children:[(0,a.jsx)("div",{className:"h-2 w-2 rounded-full mr-2 ".concat(D>0?"bg-emerald-400 animate-pulse":"bg-slate-400")}),(0,a.jsx)("span",{className:"text-sm font-medium text-slate-200",children:D>0?"Live Updates":"Connecting..."})]})]})}),(0,a.jsxs)("div",{className:"px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-semibold text-slate-800",children:"Price History"}),(0,a.jsx)("div",{className:"flex bg-slate-100 rounded-lg overflow-hidden",children:["1W","1M","3M","1Y","ALL"].map(e=>(0,a.jsx)("button",{onClick:()=>M(e),className:"px-4 py-1.5 text-sm font-medium ".concat(F===e?"bg-slate-700 text-white":"text-slate-700 hover:bg-slate-200"),children:e},e))})]}),U.length>0?(0,a.jsx)("div",{className:"h-80 w-full",children:(0,a.jsx)(n.u,{width:"100%",height:"100%",children:(0,a.jsxs)(i.b,{data:U,margin:{top:5,right:30,left:20,bottom:30},children:[(0,a.jsx)("defs",{children:(0,a.jsxs)("linearGradient",{id:"colorPrice",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,a.jsx)("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.2}),(0,a.jsx)("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),(0,a.jsx)(c.d,{strokeDasharray:"3 3",stroke:"#e5e7eb",vertical:!1}),(0,a.jsx)(d.W,{dataKey:"date",tick:{fill:"#475569"},angle:-45,textAnchor:"end",height:60,tickFormatter:e=>{let t=new Date(e);return"1W"===F||"1M"===F?t.toLocaleDateString("en-US",{month:"short",day:"numeric"}):t.toLocaleDateString("en-US",{month:"short",year:"2-digit"})}}),(0,a.jsx)(h.h,{tick:{fill:"#475569"},domain:[z,H],tickFormatter:e=>"$".concat(e.toFixed(2))}),(0,a.jsx)(x.m,{formatter:e=>"number"==typeof e?["$".concat(e.toFixed(2)),"Price"]:["".concat(e),"Price"],labelFormatter:e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),contentStyle:{backgroundColor:"#ffffff",borderColor:"#e2e8f0",borderRadius:"6px",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)",padding:"12px"}}),(0,a.jsx)(m.e,{y:f.price,stroke:"#6366f1",strokeDasharray:"3 3"}),(0,a.jsx)(u.N,{type:"monotone",dataKey:"price",stroke:"#10b981",strokeWidth:3,dot:!1,activeDot:{r:6,fill:"#047857",stroke:"#ffffff",strokeWidth:2},fillOpacity:1,fill:"url(#colorPrice)"})]})})}):(0,a.jsx)("div",{className:"h-80 w-full flex items-center justify-center bg-slate-50 rounded-lg border border-slate-100",children:(0,a.jsx)("p",{className:"text-slate-500 font-medium",children:"No price history available for the selected time range."})})]}),(0,a.jsxs)("div",{className:"px-8 py-6 bg-slate-50 border-t border-slate-100",children:[(0,a.jsxs)("h3",{className:"text-xl font-semibold text-slate-800 mb-4",children:["About ",f.name]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-slate-100",children:[(0,a.jsx)("p",{className:"text-slate-700 leading-relaxed",children:f.description||"No description available for this company."}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-6 mt-8",children:[(0,a.jsxs)("div",{className:"border-l-4 border-indigo-500 pl-4",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 uppercase font-medium",children:"Sector"}),(0,a.jsx)("p",{className:"text-slate-800 font-medium",children:"Technology"})]}),(0,a.jsxs)("div",{className:"border-l-4 border-emerald-500 pl-4",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 uppercase font-medium",children:"Exchange"}),(0,a.jsx)("p",{className:"text-slate-800 font-medium",children:"NASDAQ"})]})]})]})]})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[898,441,684,358],()=>t(39924)),_N_E=e.O()}]);